<!-- ========================== index.html ========================== -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>D`signer - Painel</title>
  <link rel="stylesheet" href="css/Painel.css"/>
</head>
<body>
  <!-- Indicador de conexão (o JS muda a cor/estado) -->
  <div id="connection-status">✓</div>

  <!-- Layout geral -->
  <div class="dashboard">
    <!-- SIDEBAR -->
    <aside class="sidebar sidebar-modern">
      <div class="brand">D`Signer</div>

      <nav class="pills">
        <button class="pill active" data-section="tvs-section" title="Dashboard">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M4 13h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1zm-1 7a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v4zm10 0a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1h-6a1 1 0 0 0-1 1v7zm1-10h6a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1h-6a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1z"/>
          </svg>
          <span>Dashboard</span>
        </button>

        <button class="pill" data-section="app-section" title="App">
          <img src="imagens/download.png" alt="App" width="24" height="24" />
          <span>App</span>
        </button>

        <button class="pill" data-section="perfil-section" title="Perfil">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M12 2a5 5 0 1 0 5 5 5 5 0 0 0-5-5zm0 8a3 3 0 1 1 3-3 3 3 0 0 1-3 3zm9 11v-1a7 7 0 0 0-7-7h-4a7 7 0 0 0-7 7v1h2v-1a5 5 0 0 1 5-5h4a5 5 0 0 1 5 5v1z"/>
          </svg>
          <span>Perfil</span>
        </button>

        <button class="pill" data-section="support-section" title="Suporte">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M11.953 2C6.465 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.493 2 11.953 2zM12 20c-4.411 0-8-3.589-8-8s3.567-8 7.953-8C16.391 4 20 7.589 20 12s-3.589 8-8 8z"></path>
            <path d="M11 7h2v7h-2zm0 8h2v2h-2z"></path>
          </svg>
          <span>Suporte</span>
        </button>

        <button class="pill pill-dskey" id="pill-dskey" title="dskey (site)">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M12 16c2.206 0 4-1.794 4-4s-1.794-4-4-4-4 1.794-4 4 1.794 4 4 4zm0-6c1.084 0 2 .916 2 2s-.916 2-2 2-2-.916-2-2 .916-2 2-2z"/>
            <path d="m2.845 16.136 1 1.73c.531.917 1.809 1.261 2.73.73l.529-.306A8.1 8.1 0 0 0 9 19.402V20c0 1.103.897 2 2 2h2c1.103 0 2-.897 2-2v-.598a8.132 8.132 0 0 0 1.896-1.111l.529.306c.923.53 2.198.188 2.731-.731l.999-1.729a2.001 2.001 0 0 0-.731-2.732l-.505-.292a7.718 7.718 0 0 0 0-2.224l.505-.292a2.002 2.002 0 0 0 .731-2.732l-.999-1.729c-.531-.92-1.808-1.265-2.731-.732l-.529.306A8.1 8.1 0 0 0 15 4.598V4c0-1.103-.897-2-2-2h-2c-1.103 0-2 .897-2 2v.598a8.132 8.132 0 0 0-1.896 1.111l-.529-.306c-.924-.531-2.2-.187-2.731.732l-.999 1.729a2.001 2.001 0 0 0 .731 2.732l.505.292a7.683 7.683 0 0 0 0 2.223l-.505.292a2.003 2.003 0 0 0-.731 2.733z"/>
          </svg>
          <span>dskey</span>
        </button>
      </nav>

      <button id="logout-link" class="logout-btn" title="Sair">Sair</button>
    </aside>

    <!-- Conteúdo principal -->
    <main class="main-content">
      <header class="topbar">
        <h2 id="section-title">Dashboard</h2>
      </header>

      <!-- TVS -->
      <section id="tvs-section" class="content-section active">
        <div class="tvs-layout">
          <div class="floor-list">
            <button class="select-categories-btn" style="display:none;">Gerenciar Andares</button>
          </div>
          <div class="content-grid">
            <div class="content-grid-header">
              <h3>Conteúdo</h3>
              <div class="grid-actions"></div>
            </div>
            <div class="grid" id="tv-grid"></div>
            <button class="add-tv-btn" style="display:none;">Adicionar TV</button>
          </div>
        </div>
      </section>

      <!-- APP -->
      <section id="app-section" class="content-section">
        <div class="app-content container-neon">
          <h2>Download do App</h2>
          <div class="demo-area">
            <h3>Como instalar</h3>
            <div class="gallery">
              <img src="imagens/logo Dsigner 2.png" alt="Screenshot 1"/>
              <img src="imagens/D.png" alt="Screenshot 2"/>
            </div>
          </div>
        </div>
      </section>

      <!-- PERFIL -->
      <!-- ======== MUDANÇA DE LAYOUT: PERFIL → GALERIA DE MÍDIA ======== -->
<!-- Substitua o conteúdo atual da seção PERFIL por este bloco -->
<section id="perfil-section" class="content-section">
  <div class="profile-content container-neon">
    <h2>Meu Perfil</h2>
    <p><strong>Email:</strong> <span id="user-email"></span></p>

    <!-- Toolbar -->
    <div class="media-toolbar">
      <input id="media-search" type="text" placeholder="Buscar por TV ou nome...">
      <select id="media-filter-type">
        <option value="">Todos os tipos</option>
        <option value="image">Imagens</option>
        <option value="gif">GIFs</option>
        <option value="video">Vídeos</option>
      </select>
      <select id="media-sort">
        <option value="newest">Mais recente</option>
        <option value="oldest">Mais antigo</option>
        <option value="name_az">Nome (A–Z)</option>
        <option value="name_za">Nome (Z–A)</option>
      </select>
    </div>

    <!-- Galeria -->
    <div id="media-gallery" class="media-gallery"></div>
  </div>
</section>

<style>
/* ===== Galeria de Mídias (Perfil) ===== */
.media-toolbar{display:flex;gap:10px;margin:12px 0 16px;flex-wrap:wrap}
.media-toolbar input,.media-toolbar select{
  background:#1a1f3b;border:1px solid #f4f5f557;border-radius:8px;
  color:#fff;padding:10px;min-height:40px;flex:1
}
.media-gallery{
  display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:14px
}
.media-card{
  background:#0a0f2b;border:1px solid #00d4ff;border-radius:12px;
  padding:10px;display:flex;flex-direction:column;gap:8px;position:relative;
  box-shadow:0 0 10px rgba(0,212,255,.18);transition:transform .2s
}
.media-card:hover{transform:translateY(-3px)}
.media-card .thumb{
  width:100%;aspect-ratio:16/9;background:#111a3a;border:1px dashed #2b3a88;
  border-radius:8px;display:grid;place-items:center;overflow:hidden
}
.media-card .thumb img,.media-card .thumb video{width:100%;height:100%;object-fit:cover}
.media-meta{display:flex;flex-direction:column;gap:4px;font-size:12px;color:#cfe8ff}
.media-name{font-weight:700;color:#fff;word-break:break-all}
.media-actions{display:flex;gap:8px;margin-top:6px;justify-content:flex-end}
.media-actions .btn{padding:8px 10px;border-radius:8px;font-weight:700;font-size:12px;cursor:pointer}
.btn-secondary{background:#11204a;color:#9fdfff;border:1px solid #00d4ff}
.btn-secondary:hover{background:#0f1a3a}
.btn-danger{background:#ef4444;color:#fff;border:1px solid #ef4444}
.btn-danger:hover{background:#dc2626}
.rename-row{display:none;gap:6px;align-items:center;margin-top:6px}
.rename-row input{
  flex:1;background:#1a1f3b;border:1px solid #f4f5f557;border-radius:6px;color:#fff;padding:8px
}
.media-badge{
  position:absolute;top:10px;left:10px;background:#0f142f;border:1px solid #00d4ff;
  color:#9fdfff;font-size:10px;padding:2px 6px;border-radius:999px
}
.media-dot{position:absolute;top:10px;right:10px;width:10px;height:10px;border-radius:50%}
.media-dot.active{background:#4CAF50;box-shadow:0 0 12px rgba(76,175,80,.7)}
.media-dot.inactive{background:#ff5252;box-shadow:0 0 12px rgba(255,82,82,.6)}
</style>

<script>
/* ===== Galeria de mídia (render + filtros + renomear/excluir) ===== */
(function(){
  // Ícone de vídeo (thumb)
  const PLAY_ICON = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBvbHlnb24gcG9pbnRzPSI2LDQgMjAsMTIgNiwyMCIgZmlsbD0iIzAwZDRmZiIvPjwvc3ZnPg==';

  async function loadMediaGallery(){
    const gallery = document.getElementById('media-gallery');
    if (!gallery) return;
    gallery.innerHTML = '';
    if (!window.currentUserId || !window.isOnline || !isOnline()){ showToast('Sem internet','error'); return; }

    const snap = await authModule.database.ref(`users/${currentUserId}/tv_midias`).once('value');
    const data = snap.val() || {};
    const items = [];

    for (const tvSlug in data){
      const medias = data[tvSlug] || {};
      for (const mediaName in medias){
        const it = medias[mediaName];
        const ext = (it.url||'').split('?')[0].split('.').pop()?.toLowerCase() || '';
        items.push({
          keyTvSlug: tvSlug, keyMediaName: mediaName,
          tvName: it.tvName, url: it.url, mediaType: it.mediaType,
          active: !!it.active, timestamp: it.timestamp||0, storagePath: it.storagePath||'', ext
        });
      }
    }

    // filtros
    const q = (document.getElementById('media-search')?.value||'').toLowerCase();
    const fType = document.getElementById('media-filter-type')?.value || '';
    const sort = document.getElementById('media-sort')?.value || 'newest';

    let filtered = items.filter(it=>{
      const passType = !fType || it.mediaType === fType;
      const passText = !q || `${it.tvName} ${it.keyMediaName}`.toLowerCase().includes(q);
      return passType && passText;
    });

    filtered.sort((a,b)=>{
      if (sort==='newest') return (b.timestamp||0)-(a.timestamp||0);
      if (sort==='oldest') return (a.timestamp||0)-(b.timestamp||0);
      if (sort==='name_az') return a.keyMediaName.localeCompare(b.keyMediaName);
      if (sort==='name_za') return b.keyMediaName.localeCompare(a.keyMediaName);
      return 0;
    });

    if (!filtered.length){
      gallery.innerHTML = '<div class="no-items">Nenhuma mídia encontrada.</div>';
      return;
    }

    for (const it of filtered){
      const card = document.createElement('div'); card.className='media-card';

      const thumb = document.createElement('div'); thumb.className='thumb';
      if (it.mediaType==='video'){
        const img = document.createElement('img'); img.src = PLAY_ICON; img.alt='Vídeo'; thumb.appendChild(img);
      } else {
        const img = document.createElement('img');
        img.src = it.url; img.alt = it.keyMediaName; img.loading='lazy';
        img.onerror = ()=>{ img.remove(); const p=document.createElement('div'); p.textContent='(sem preview)'; thumb.appendChild(p); };
        thumb.appendChild(img);
      }

      const badge = document.createElement('div'); badge.className='media-badge'; badge.textContent = `${(it.mediaType||'').toUpperCase()} • ${it.tvName||''}`;
      const dot = document.createElement('div'); dot.className = `media-dot ${it.active?'active':'inactive'}`;

      const meta = document.createElement('div'); meta.className='media-meta';
      const name = document.createElement('div'); name.className='media-name'; name.textContent = it.keyMediaName;
      const when = it.timestamp ? new Date(it.timestamp).toLocaleString() : '—';
      const info = document.createElement('div'); info.textContent = `Criado: ${when}`;
      meta.appendChild(name); meta.appendChild(info);

      const actions = document.createElement('div'); actions.className='media-actions';
      const btnRename = document.createElement('button'); btnRename.className='btn btn-secondary'; btnRename.textContent='Renomear';
      const btnDelete = document.createElement('button'); btnDelete.className='btn btn-danger'; btnDelete.textContent='Excluir';
      actions.appendChild(btnRename); actions.appendChild(btnDelete);

      const renameRow = document.createElement('div'); renameRow.className='rename-row';
      renameRow.innerHTML = `
        <input type="text" value="${it.keyMediaName}" aria-label="Novo nome">
        <button class="btn btn-secondary do-save">Salvar</button>
        <button class="btn cancel">Cancelar</button>
      `;

      // handlers
      btnRename.addEventListener('click', ()=>{ renameRow.style.display='flex'; renameRow.querySelector('input')?.focus(); });
      renameRow.querySelector('.cancel').addEventListener('click', ()=>{ renameRow.style.display='none'; });
      renameRow.querySelector('.do-save').addEventListener('click', async ()=>{
        const inp = renameRow.querySelector('input'); const newBase = (inp.value||'').trim();
        if (!newBase){ showToast('Informe um nome válido','error'); return; }
        if (newBase === it.keyMediaName){ renameRow.style.display='none'; return; }
        try{
          await renameMedia(it.keyTvSlug, it.keyMediaName, newBase, it.storagePath, it.ext, it);
          showToast('Mídia renomeada','success');
          await loadMediaGallery();
        }catch(e){ console.error(e); showToast('Erro ao renomear','error'); }
      });

      btnDelete.addEventListener('click', async ()=>{
        if (!confirm('Tem certeza que deseja excluir esta mídia?')) return;
        try{
          // usa a função já existente no seu Painel.js
          await deleteMedia(it.keyTvSlug, it.keyMediaName, it.storagePath);
          await loadMediaGallery();
        }catch(e){ console.error(e); showToast('Erro ao excluir','error'); }
      });

      card.appendChild(thumb);
      card.appendChild(badge);
      card.appendChild(dot);
      card.appendChild(meta);
      card.appendChild(actions);
      card.appendChild(renameRow);
      gallery.appendChild(card);
    }
  }

  // Renomear: copia no Storage com novo nome + atualiza DB e referências da TV
  async function renameMedia(tvSlug, oldName, newBase, oldStoragePath, extFromUrl, originalItem){
    if (!window.currentUserId || !isOnline()) throw new Error('Offline');
    const tv = (window.tvs||[]).find(t => tvSlugFromName(t.name) === tvSlug);
    if (!tv) throw new Error('TV não encontrada');

    const keepExt = extFromUrl ? `.${extFromUrl}` : '';
    const newFileName = `${Date.now()}_${newBase.replace(/\s+/g,'_').toLowerCase()}${keepExt}`;
    const newStoragePath = `tv_media/${tvSlug}/${newFileName}`;

    // baixa blob antigo e envia como novo (Firebase não tem rename nativo)
    const oldRef = authModule.storage.ref().child(oldStoragePath);
    const oldUrl = await oldRef.getDownloadURL();
    const blob = await fetch(oldUrl).then(r=>r.blob());
    const newRef = authModule.storage.ref().child(newStoragePath);
    await newRef.put(blob);
    const newURL = await newRef.getDownloadURL();

    // novo registro no DB
    const now = Date.now();
    const newEntry = {
      tvId: tv.id, tvName: tv.name, mediaName: newBase, mediaType: originalItem.mediaType,
      url: newURL, content:null, color:null, bgColor:null, fontSize:null,
      duration:null, loop:false, timestamp: originalItem.timestamp||now, lastActive: now,
      active: !!originalItem.active, storagePath: newStoragePath
    };
    const basePath = `users/${currentUserId}/tv_midias/${tvSlug}`;
    await authModule.database.ref(`${basePath}/${newBase}`).set(newEntry);
    await authModule.database.ref(`${basePath}/${oldName}`).remove();

    // atualiza referências na TV (media/playlist)
    let changed = false;
    if (Array.isArray(tv.playlist) && tv.playlist.length){
      const updated = tv.playlist.map(item=>{
        try{
          const n = item.url ? getMediaNameFromUrl(tv.name, item.url) : null;
          return (n===oldName) ? {...item, url:newURL} : item;
        }catch{ return item; }
      });
      if (JSON.stringify(updated)!==JSON.stringify(tv.playlist)){ tv.playlist = updated; changed = true; }
    }
    if (tv.media && tv.media.url){
      try{
        const n = getMediaNameFromUrl(tv.name, tv.media.url);
        if (n===oldName){ tv.media = {...tv.media, url:newURL}; changed = true; }
      }catch{}
    }

    // recalcula ativos e persiste
    const actives = [];
    if (tv.playlist && tv.playlist.length){
      for (const it of tv.playlist){
        const n = it.url ? getMediaNameFromUrl(tv.name, it.url) : null;
        if (n) actives.push(n);
      }
    } else if (tv.media && tv.media.url){
      const n = getMediaNameFromUrl(tv.name, tv.media.url);
      if (n) actives.push(n);
    }
    tv.activeMediaNames = actives;
    await updateActiveMediaStatus(tvSlug, actives);

    await authModule.database.ref(`users/${currentUserId}/tvs/${tv.id}`).update({
      media: tv.media || null, playlist: tv.playlist || null, lastUpdate: Date.now()
    });
    if (tv.activationKey){
      if (tv.playlist && tv.playlist.length){
        await authModule.database.ref('midia/' + tv.activationKey).set({ tipo:'playlist', items: tv.playlist, timestamp: Date.now() });
      } else if (tv.media){
        const m = tv.media;
        await authModule.database.ref('midia/' + tv.activationKey).set({
          tipo:m.type, url:m.url||null, content:null, color:null, bgColor:null,
          fontSize:null, duration:m.duration||null, loop:m.loop||false, timestamp: Date.now()
        });
      }
    }

    // apaga arquivo antigo
    await oldRef.delete().catch(()=>{});
  }

  // Bind da toolbar
  ['media-search','media-filter-type','media-sort'].forEach(id=>{
    const el = document.getElementById(id);
    if (!el) return;
    const ev = id==='media-search' ? 'input' : 'change';
    el.addEventListener(ev, () => loadMediaGallery());
  });

  // Carrega assim que a aba Perfil abrir (observa ativação por clique no menu)
  document.addEventListener('click', (e)=>{
    const pill = e.target.closest('.sidebar-modern .pill[data-section="perfil-section"]');
    if (pill) setTimeout(loadMediaGallery, 50);
  });
  // ou carregue imediatamente se a seção já estiver visível
  if (document.getElementById('perfil-section')?.classList.contains('active')){
    loadMediaGallery();
  }
})();
</script>
<!-- ======== /MUDANÇA DE LAYOUT ======== -->


      <!-- SUPORTE -->
      <section id="support-section" class="content-section">
        <div class="support-content container-neon">
          <h2>Suporte Técnico</h2>
          <form id="support-form">
            <div class="form-group">
              <label for="support-email">Email:</label>
              <input type="email" id="support-email" name="email" required/>
            </div>
            <div class="form-group">
              <label for="support-empresa">Nome da Empresa:</label>
              <input type="text" id="support-empresa" name="empresa" required/>
            </div>
            <div class="form-group">
              <label for="support-chamado">Mensagem:</label>
              <textarea id="support-chamado" name="chamado" required></textarea>
            </div>
            <button type="submit" class="btn">Enviar Chamado</button>
            <div id="support-message" class="message"></div>
          </form>
        </div>
      </section>
    </main>
  </div>

  <!-- Modais -->
  <div class="modal" id="category-modal">
    <div class="modal-content container-neon">
      <span class="close-btn">×</span>
      <h2>Gerenciar Andares</h2>
      <div class="category-form">
        <h3>Adicionar Novo Andar</h3>
        <div class="form-group">
          <label for="new-category-name">Nome do Andar:</label>
          <input type="text" id="new-category-name" placeholder="Ex.: Andar 3"/>
        </div>
        <button id="add-category-btn" class="btn">Adicionar Andar</button>
      </div>
    </div>
  </div>

  <div class="modal" id="edit-floor-modal">
    <div class="modal-content container-neon">
      <span class="close-btn">×</span>
      <h2>Editar Andar</h2>
      <div class="form-group">
        <label for="edit-floor-name">Nome do Andar:</label>
        <input type="text" id="edit-floor-name"/>
      </div>
      <button id="save-floor-btn" class="btn">Salvar</button>
    </div>
  </div>

  <div class="modal" id="add-tv-modal">
    <div class="modal-content container-neon">
      <span class="close-btn">×</span>
      <h2>Adicionar TV</h2>
      <div class="form-group">
        <label for="tv-name">Nome da TV:</label>
        <input type="text" id="tv-name" placeholder="Ex.: TV Sala 1"/>
      </div>
      <div class="form-group">
        <label for="tv-category">Andar:</label>
        <select id="tv-category"></select>
      </div>
      <div class="form-group">
        <label for="tv-activation-key">Chave de Ativação:</label>
        <input type="text" id="tv-activation-key" placeholder="Cole a chave do Dskey aqui" required/>
      </div>
      <button id="add-tv-submit-btn" class="btn">Adicionar TV</button>
    </div>
  </div>

  <div class="modal" id="view-media-modal">
    <div class="modal-content container-neon">
      <span class="close-btn">×</span>
      <h2>Mídia da TV</h2>
      <div id="media-container"></div>
    </div>
  </div>

  <!-- MODAL DE ENVIO: Arquivo/Link + Playlist -->
  <div class="modal" id="upload-media-modal">
    <div class="modal-content container-neon">
      <span class="close-btn">×</span>
      <h2>Enviar Mídia</h2>

      <!-- Abas -->
      <div class="upload-tabs">
        <button class="tab-btn active" id="tab-file" data-mode="file">Arquivo</button>
        <button class="tab-btn" id="tab-link" data-mode="link">Link URL</button>
      </div>

      <!-- Toggle Playlist -->
      <div class="playlist-toggle">
        <span style="min-width:82px;">Playlist:</span>
        <div id="playlist-switch" class="switch" role="switch" aria-checked="false" tabindex="0"></div>
        <small class="link-hint">Ative para enviar várias mídias por vez</small>
      </div>

      <!-- Modo Arquivo (Dropzone) -->
      <div id="file-mode">
        <div class="dz-container" id="dz">
          <div class="dz-header" id="dz-header">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M7 10V9C7 6.24 9.24 4 12 4s5 2.24 5 5v1c2.21 0 4 1.79 4 4 0 1.48-.8 2.81-2 3.5M7 10C4.79 10 3 11.79 3 14c0 1.48.8 2.81 2 3.5M7 10c.43 0 .85.07 1.24.2M12 12v9m0-9l3 3m-3-3l-3 3" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <p>Arraste arquivos aqui<br><small>(imagem, GIF, ou vídeo MP4)</small></p>
          </div>

          <label for="dz-file" class="dz-footer" id="dz-footer">
            <svg viewBox="0 0 32 32" aria-hidden="true"><path d="M15.331 6H8.5v20h15V14.154h-8.169z"></path><path d="M18.153 6h-.009v5.342H23.5v-.002z"></path></svg>
            <p id="dz-file-label">Nenhum arquivo selecionado</p>
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M5.166 10.153C5.076 8.992 5.995 8 7.16 8h9.68c1.165 0 2.084.992 1.995 2.153l-.692 9c-.08 1.042-.948 1.847-1.993 1.847H7.852c-1.045 0-1.914-.805-1.994-1.847l-.692-9Z" stroke="currentColor" stroke-width="2" fill="none"></path>
              <path d="M19.5 5H4.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
              <path d="M10 3c0-.552.448-1 1-1h2a1 1 0 0 1 1 1v2h-4V3Z" stroke="currentColor" stroke-width="2" fill="none"></path>
            </svg>
          </label>

          <input id="dz-file" type="file" accept="image/*,video/mp4,.gif" />
        </div>

        <div class="upload-progress"><div class="progress-bar"></div></div>
        <div id="dz-preview-wrap" class="dz-preview-wrap" style="display:none;">
          <img id="dz-preview" class="media-preview" alt="Pré-visualização" />
          <ul id="dz-list" class="dz-list"></ul>
        </div>
      </div>

      <!-- Modo Link -->
      <div id="link-mode" class="hidden">
        <div class="link-fields">
          <div class="form-group">
            <label for="link-url">URL da mídia:</label>
            <input type="url" id="link-url" placeholder="https://... (imagem, GIF ou vídeo MP4)"/>
            <div class="link-hint">Use links diretos (acesso público). Para Storage com token público também funciona.</div>
          </div>

          <div class="link-inline">
            <div class="form-group">
              <label for="link-type">Tipo:</label>
              <select id="link-type">
                <option value="image">Imagem</option>
                <option value="gif">GIF</option>
                <option value="video">Vídeo (MP4)</option>
              </select>
            </div>
            <div class="form-group" id="link-duration-wrap">
              <label for="link-duration">Duração (s):</label>
              <input type="number" id="link-duration" min="1" value="10"/>
            </div>
          </div>

          <div class="form-group hidden" id="link-loop-wrap">
            <label><input type="checkbox" id="link-loop"/> Repetir vídeo (loop)</label>
          </div>
        </div>
      </div>

      <button id="upload-media-btn" class="btn" onclick="uploadMidia()">Enviar</button>
      <div id="upload-status" class="message"></div>
    </div>
  </div>

  <!-- MODAL: INFORMAÇÕES / ATIVAÇÃO -->
  <div class="modal" id="activation-info-modal">
    <div class="modal-content container-neon">
      <span class="close-btn">×</span>
      <h2>Informações de Ativação</h2>

      <div class="form-group">
        <label>Chave de Ativação:</label>
        <div class="key-row">
          <input type="text" id="activation-key-display" class="key-input" readonly />
          <button class="btn-secondary" id="btn-copy-key" title="Copiar">Copiar</button>
          <button class="btn" id="btn-edit-key" title="Editar">Editar</button>
        </div>
        <div class="key-row" id="key-edit-row" style="display:none; gap:8px;">
          <input type="text" id="activation-key-input" class="key-input" placeholder="Cole a nova chave aqui" />
          <button class="btn" id="btn-save-key">Salvar</button>
          <button class="btn-secondary" id="btn-cancel-key">Cancelar</button>
        </div>
      </div>

      <div class="form-group">
        <label>Nome do Dispositivo:</label>
        <div class="device-info-value" id="activation-device-info"></div>
      </div>
      <div class="form-group">
        <label>Última Ativação:</label>
        <div class="device-info-value" id="activation-last-info"></div>
      </div>
    </div>
  </div>

  <!-- FAB de ações -->
  <div class="fab-container">
    <button class="fab-main" aria-label="Ações">
      <span style="font-size:33px;line-height:1">+</span>
    </button>
    <div class="fab-menu">
      <button class="select-categories-btn">Gerenciar Andares</button>
      <button class="add-tv-btn">Adicionar TV</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/Painel.js"></script>
</body>
</html>
<!-- ======================== /index.html ======================== -->
