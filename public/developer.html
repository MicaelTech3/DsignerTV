<!DOCTYPE html>
<html lang="pt-BR" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DevConsole ¬∑ DSigner</title>
<link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
 <link rel="shortcut icon" href="imagens/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="css/developer.css">
</head>
<body>

<!-- Firebase SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>

<!-- LOGIN -->
<div id="login-screen">
  <div class="login-box">
    <div class="login-logo">
      <div class="login-logo-mark">
        <svg viewBox="0 0 10 10" width="12"><path d="M2 2h6v2H5v4H3V4H2z"/></svg>
      </div>
      <div class="login-logo-text">DSIGNER ¬∑ DEV</div>
    </div>
    <div class="login-title">Developer Console</div>
    <div class="login-sub">Acesso restrito ‚Äî equipe t√©cnica</div>
    <div class="form-group">
      <label class="form-label">Email</label>
      <input class="form-input" type="email" id="login-email" placeholder="dev@dsigner.com" autocomplete="email">
    </div>
    <div class="form-group">
      <label class="form-label">Senha</label>
      <input class="form-input" type="password" id="login-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="current-password">
    </div>
    <button class="btn-primary" id="login-btn">Entrar</button>
    <div class="login-error" id="login-err"></div>
  </div>
</div>

<!-- APP -->
<div id="app">
  <!-- TOPBAR -->
  <div class="topbar">
    <div class="topbar-logo">
      <div class="topbar-logo-mark">
        <svg viewBox="0 0 10 10" width="10"><path d="M2 2h6v2H5v4H3V4H2z"/></svg>
      </div>
      DSIGNER
    </div>
    <div class="topbar-sep"></div>
    <span class="topbar-badge">DEV CONSOLE</span>
    <div class="topbar-right">
      <div class="user-pill"><div class="user-dot"></div><span id="topbar-email">‚Äî</span></div>
      <a href="https://dsignertv.com.br" target="_blank" class="btn-icon" title="Abrir site" style="text-decoration:none;font-size:11px;width:auto;padding:0 10px;gap:5px;display:flex">
        <svg width="11" height="11" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 1.5a5.5 5.5 0 110 11 5.5 5.5 0 010-11zm0 1c-.8 0-1.8 1.5-2.2 4h4.4c-.4-2.5-1.4-4-2.2-4zm-2.4.5A6.1 6.1 0 004 8h2.3c.1-1.1.3-2.1.7-3zm4.8 0c.4.9.6 1.9.7 3H13a6.1 6.1 0 00-1.6-3zM4 8.5c0 1 .2 2 .6 2.9A6.1 6.1 0 004 8.5zm2.3 0H4c.1 1.2.6 2.3 1.3 3.1.4-.9.6-1.9.7-3.1zm1 0c-.1 1.4-.5 2.7-1.1 3.6.8.3 1.4.4 1.8.4s1-.1 1.8-.4c-.6-.9-1-2.2-1.1-3.6zm2.4 0c.1 1.2.3 2.2.7 3.1A5.4 5.4 0 0012 8.5h-2.3zm2.3 0H13c0 .9-.2 1.7-.6 2.4z"/></svg>
        Site
      </a>
      <button class="btn-icon" id="theme-toggle" title="Alternar tema">‚óê</button>
      <button class="btn-icon" id="logout-btn" title="Sair">‚èª</button>
    </div>
  </div>

  <!-- SIDEBAR -->
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-section">Vis√£o Geral</div>
    <div class="nav-item active" data-section="overview">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M1 1h6v6H1zm8 0h6v6H9zM1 9h6v6H1zm8 0h6v6H9z"/></svg>
      <span>Dashboard</span>
    </div>

    <div class="sidebar-section" style="margin-top:8px">Banco de Dados</div>
    <div class="nav-item" data-section="users-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><circle cx="8" cy="5" r="3"/><path d="M2 14c0-3.3 2.7-6 6-6s6 2.7 6 6H2z"/></svg>
      <span>Usu√°rios</span>
    </div>
    <div class="nav-item" data-section="tvs-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><rect x="1" y="3" width="14" height="9" rx="1"/><path d="M5 13h6v1H5z"/></svg>
      <span>TVs</span>
    </div>
    <div class="nav-item" data-section="media-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M1 2h14v12H1zm2 2v8h10V4H3zm3 1l4 3-4 3V5z"/></svg>
      <span>M√≠dias</span>
    </div>
    <div class="nav-item" data-section="categories-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M1 1h6v6H1zm8 0h6v3H9zm0 5h6v3H9zM1 9h14v2H1zm0 4h14v2H1z"/></svg>
      <span>Categorias</span>
    </div>

    <div class="sidebar-section" style="margin-top:8px">Avan√ßado</div>
    <div class="nav-item" data-section="db-browser">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><ellipse cx="8" cy="4" rx="6" ry="2"/><path d="M2 4v3c0 1.1 2.7 2 6 2s6-.9 6-2V4"/><path d="M2 7v3c0 1.1 2.7 2 6 2s6-.9 6-2V7"/><path d="M2 10v2c0 1.1 2.7 2 6 2s6-.9 6-2v-2"/></svg>
      <span>DB Browser</span>
    </div>
    <div class="nav-item" data-section="realtime-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zM7 8V4h2v4H7zm0 2h2v2H7v-2z"/></svg>
      <span>Realtime Midia</span>
    </div>
    <div class="nav-item" data-section="rules-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M2 2h12v2H2zm0 4h8v2H2zm0 4h10v2H2zm0 4h6v2H2z"/></svg>
      <span>Rules Viewer</span>
    </div>

    <div class="nav-item" data-section="plans-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zM3 8a5 5 0 1110 0A5 5 0 013 8zm4.5-3v3.25l2.5 1.5-.5.86L6.5 8.75V5h1z"/></svg>
      <span>Planos</span>
    </div>
    <div class="nav-item" data-section="tickets-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M2 2h12v9H9l-3 3v-3H2V2zm1 1v7h3v2l2-2h4V3H3z"/></svg>
      <span>Chamados <span id="ticket-badge" style="display:none;background:var(--red);color:#fff;font-size:9px;padding:1px 5px;border-radius:8px;margin-left:4px;font-family:var(--mono)">0</span></span>
    </div>

    <div class="sidebar-section" style="margin-top:8px">Cobran√ßas</div>
    <div class="nav-item" data-section="change-plans-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm.75 4v1.5h1.5a.75.75 0 010 1.5H8.75v1h1.5a.75.75 0 010 1.5H8.75V11a.75.75 0 01-1.5 0v-.5H5.75a.75.75 0 010-1.5h1.5v-1H5.75a.75.75 0 010-1.5h1.5V5a.75.75 0 011.5 0z"/></svg>
      <span>Change Plans <span id="cp-badge" style="display:none;background:var(--red);color:#fff;font-size:9px;padding:1px 5px;border-radius:8px;margin-left:4px;font-family:var(--mono)">0</span></span>
    </div>
    <div class="nav-item" data-section="settings-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 5a3 3 0 100 6A3 3 0 008 5zm0 1.5a1.5 1.5 0 110 3 1.5 1.5 0 010-3zM6.5 1l-.5 1.5-1.4.6L3 2.5 2 3.5l.6 1.6L2 6.5l1.5.5.6 1.4L2.5 10l1 1 1.6-.6 1.4.6.5 1.5h2l.5-1.5 1.4-.6 1.6.6 1-1-.6-1.6.6-1.4L14 6.5l-.5-1.4.6-1.6-1-1-1.6.6L10 2.5l-.5-1.5h-3z"/></svg>
      <span>Settings</span>
    </div>

    <div class="sidebar-section" style="margin-top:8px">Produto</div>
    <div class="nav-item" data-section="apps-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M3 2h4v4H3zm6 0h4v4H9zM3 9h4v4H3zm6 0h4v4H9z"/></svg>
      <span>App & Active</span>
    </div>
    <div class="nav-item" data-section="dominios-section">
      <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor"><path d="M8 1a7 7 0 100 14A7 7 0 008 1zm0 1.5a5.5 5.5 0 110 11 5.5 5.5 0 010-11zm0 1c-.8 0-1.8 1.5-2.2 4h4.4c-.4-2.5-1.4-4-2.2-4zm-2.4.5A6.1 6.1 0 004 8h2.3c.1-1.1.3-2.1.7-3zm4.8 0c.4.9.6 1.9.7 3H13a6.1 6.1 0 00-1.6-3zM4 8.5c0 1 .2 2 .6 2.9A6.1 6.1 0 004 8.5zm2.3 0H4c.1 1.2.6 2.3 1.3 3.1.4-.9.6-1.9.7-3.1zm1 0c-.1 1.4-.5 2.7-1.1 3.6.8.3 1.4.4 1.8.4s1-.1 1.8-.4c-.6-.9-1-2.2-1.1-3.6zm2.4 0c.1 1.2.3 2.2.7 3.1A5.4 5.4 0 0012 8.5h-2.3zm2.3 0H13c0 .9-.2 1.7-.6 2.4z"/></svg>
      <span>Dom√≠nios</span>
    </div>
  </nav>

  <!-- MAIN -->
  <main class="main">

    <!-- OVERVIEW -->
    <div class="section active" id="overview">
      <div class="page-header">
        <div>
          <div class="page-title">Dashboard</div>
          <div class="page-sub">Resumo geral do banco de dados</div>
        </div>
        <button class="btn-sm" id="refresh-overview">‚Üª Atualizar</button>
      </div>

      <div class="stats-grid" id="stats-grid">
        <div class="stat-card"><div class="stat-label">Usu√°rios</div><div class="stat-value" id="stat-users">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">TVs</div><div class="stat-value" id="stat-tvs">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Categorias</div><div class="stat-value" id="stat-cats">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">M√≠dias</div><div class="stat-value" id="stat-medias">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">TVs Online</div><div class="stat-value" id="stat-online" style="color:var(--green)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Keys Ativas</div><div class="stat-value" id="stat-keys">‚Äî</div></div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">USU√ÅRIOS RECENTES</div>
        </div>
        <div class="table-wrap">
          <table id="overview-users-table">
            <thead><tr><th>Email</th><th>TVs</th><th>Categorias</th><th>M√≠dias</th><th>A√ß√µes</th></tr></thead>
            <tbody id="overview-users-body"><tr><td colspan="5" class="loading"><div class="spinner"></div>Carregando...</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- USERS -->
    <div class="section" id="users-section">
      <div class="page-header">
        <div>
          <div class="page-title">Usu√°rios</div>
          <div class="page-sub">Todos os usu√°rios no banco</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn-sm" onclick="loadUsers()">‚Üª Atualizar</button>
          <button class="btn-sm primary" onclick="openModal('create-user-modal')">+ Criar Usu√°rio</button>
        </div>
      </div>
      <div class="table-card">
        <div class="table-header">
          <div class="table-title">USU√ÅRIOS</div>
          <div class="table-actions">
            <input class="search-input" id="user-search" placeholder="Filtrar..." oninput="filterTable('users-body', this.value)">
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>ID (email codificado)</th><th>Email</th><th>TVs</th><th>Cats</th><th>M√≠dias</th><th>Storage</th><th>Plano</th><th>A√ß√µes</th></tr></thead>
            <tbody id="users-body"><tr><td colspan="6" class="loading"><div class="spinner"></div>Carregando...</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- TVs -->
    <div class="section" id="tvs-section">
      <div class="page-header">
        <div>
          <div class="page-title">TVs</div>
          <div class="page-sub">Selecione um usu√°rio para ver suas TVs</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn-sm" id="tv-refresh-btn" onclick="loadTvsForUser()" style="display:none">‚Üª Atualizar</button>
          <button class="btn-sm primary" id="tv-add-btn" onclick="openCreateTvModal()" style="display:none">+ Nova TV</button>
        </div>
      </div>

      <!-- User picker -->
      <div class="table-card" style="margin-bottom:16px">
        <div class="table-header">
          <div class="table-title">SELECIONAR USU√ÅRIO</div>
        </div>
        <div style="padding:14px 16px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <select class="edit-input" id="tv-user-select" style="max-width:340px;flex:1" onchange="onTvUserChange()">
            <option value="">‚Äî escolha um usu√°rio ‚Äî</option>
          </select>
          <span id="tv-user-stats" class="badge badge-gray" style="display:none"></span>
        </div>
      </div>

      <!-- TVs table -->
      <div class="table-card" id="tv-table-card" style="display:none">
        <div class="table-header">
          <div class="table-title" id="tv-table-title">DISPOSITIVOS</div>
          <div class="table-actions">
            <input class="search-input" id="tv-search" placeholder="Filtrar..." oninput="filterTable('tvs-body', this.value)">
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Nome</th><th>Categoria</th><th>Status</th><th>Activation Key</th><th>M√≠dia Atual</th><th>A√ß√µes</th></tr></thead>
            <tbody id="tvs-body"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- MEDIA -->
    <div class="section" id="media-section">
      <div class="page-header">
        <div>
          <div class="page-title">M√≠dias</div>
          <div class="page-sub">Selecione um usu√°rio para ver suas m√≠dias</div>
        </div>
        <button class="btn-sm" id="media-refresh-btn" onclick="loadMediaForUser()" style="display:none">‚Üª Atualizar</button>
      </div>

      <!-- User picker -->
      <div class="table-card" style="margin-bottom:16px">
        <div class="table-header">
          <div class="table-title">SELECIONAR USU√ÅRIO</div>
        </div>
        <div style="padding:14px 16px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <select class="edit-input" id="media-user-select" style="max-width:340px;flex:1" onchange="onMediaUserChange()">
            <option value="">‚Äî escolha um usu√°rio ‚Äî</option>
          </select>
          <span id="media-user-stats" class="badge badge-gray" style="display:none"></span>
        </div>
      </div>

      <!-- Media table -->
      <div class="table-card" id="media-table-card" style="display:none">
        <div class="table-header">
          <div class="table-title" id="media-table-title">M√çDIAS</div>
          <div class="table-actions">
            <input class="search-input" placeholder="Filtrar..." oninput="filterTable('media-body', this.value)">
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Nome</th><th>TV</th><th>Tipo</th><th>Status</th><th>Data</th><th>A√ß√µes</th></tr></thead>
            <tbody id="media-body"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- CATEGORIES -->
    <div class="section" id="categories-section">
      <div class="page-header">
        <div>
          <div class="page-title">Categorias</div>
          <div class="page-sub">Grupos de TVs por usu√°rio</div>
        </div>
        <button class="btn-sm" onclick="loadAllCategories()">‚Üª Atualizar</button>
      </div>
      <div class="table-card">
        <div class="table-header">
          <div class="table-title">CATEGORIAS</div>
          <div class="table-actions">
            <input class="search-input" placeholder="Filtrar..." oninput="filterTable('cats-body', this.value)">
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>ID</th><th>Nome</th><th>Usu√°rio</th><th>Status</th><th>TVs</th><th>A√ß√µes</th></tr></thead>
            <tbody id="cats-body"><tr><td colspan="6" class="loading"><div class="spinner"></div>Carregando...</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- DB BROWSER -->
    <div class="section" id="db-browser">
      <div class="page-header">
        <div>
          <div class="page-title">DB Browser</div>
          <div class="page-sub">Explorador de n√≥s do Firebase Realtime Database</div>
        </div>
        <div style="display:flex;gap:8px">
          <input class="search-input" id="db-path-input" placeholder="users/userId/tvs" style="width:260px">
          <button class="btn-sm primary" onclick="browsePath()">Ir ‚Üí</button>
        </div>
      </div>
      <div class="path-bar" id="path-bar"><span class="path-current">raiz</span></div>
      <div id="db-tree"></div>
    </div>

    <!-- REALTIME MIDIA -->
    <div class="section" id="realtime-section">
      <div class="page-header">
        <div>
          <div class="page-title">Realtime Midia</div>
          <div class="page-sub">Monitor e envio de comandos para TVs via /midia/{key}</div>
        </div>
      </div>
      <div class="table-card" style="margin-bottom:20px">
        <div class="table-header">
          <div class="table-title">ENVIAR COMANDO</div>
        </div>
        <div style="padding:16px;display:grid;grid-template-columns:1fr 1fr;gap:12px">
          <div>
            <div class="edit-label" style="margin-bottom:4px">Activation Key</div>
            <input class="edit-input" id="rt-key" placeholder="ex: ABC123">
          </div>
          <div>
            <div class="edit-label" style="margin-bottom:4px">Tipo</div>
            <select class="edit-input" id="rt-type" onchange="updateRtFields()">
              <option value="image">image</option>
              <option value="video">video</option>
              <option value="stop">stop</option>
              <option value="activation">activation</option>
            </select>
          </div>
          <div>
            <div class="edit-label" style="margin-bottom:4px">URL</div>
            <input class="edit-input" id="rt-url" placeholder="https://...">
          </div>
          <div>
            <div class="edit-label" style="margin-bottom:4px">Duration (s)</div>
            <input class="edit-input" id="rt-duration" type="number" value="10">
          </div>
          <div style="grid-column:1/-1">
            <button class="btn-sm primary" onclick="sendRealtimeCommand()" style="margin-right:8px">‚ö° Enviar</button>
            <button class="btn-sm" onclick="monitorKey()">üëÅ Monitorar</button>
          </div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">MONITOR REALTIME</div>
          <div class="table-actions">
            <span id="rt-status" class="badge badge-gray">offline</span>
          </div>
        </div>
        <div style="padding:16px">
          <div class="json-viewer" id="rt-monitor">Nenhum dado. Insira uma key e clique em Monitorar.</div>
        </div>
      </div>
    </div>

    <!-- RULES VIEWER -->
    <div class="section" id="rules-section">
      <div class="page-header">
        <div>
          <div class="page-title">Rules Viewer</div>
          <div class="page-sub">Visualiza√ß√£o das regras atuais do Firebase Realtime Database</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn-sm" onclick="loadRules()">‚Üª Recarregar</button>
          <button class="btn-sm" onclick="copyRules()">‚éò Copiar JSON</button>
        </div>
      </div>

      <div class="table-card" style="margin-bottom:16px">
        <div class="table-header">
          <div class="table-title">REGRAS ATUAIS</div>
          <div class="table-actions">
            <span class="badge badge-yellow">‚ö† somente leitura via console</span>
          </div>
        </div>
        <div style="padding:16px">
          <div style="background:var(--yellow-bg);border:1px solid var(--yellow);border-radius:var(--radius);padding:10px 14px;margin-bottom:14px;font-size:12px;color:var(--yellow);font-family:var(--mono)">
            ‚ö† A API do Firebase n√£o permite ler/editar Rules via SDK client. Para editar, acesse o <a href="https://console.firebase.google.com/project/dsignertv/database/dsignertv-default-rtdb/rules" target="_blank" style="color:var(--blue)">Firebase Console ‚Üí Rules</a>. Abaixo est√£o as regras atuais do sistema (hardcoded para refer√™ncia).
          </div>
          <div class="json-viewer" id="rules-viewer" style="max-height:600px"></div>
        </div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">RULES PLAYGROUND ‚Äî TESTE DE PERMISS√ÉO</div>
        </div>
        <div style="padding:16px;display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px">
          <div>
            <div class="edit-label" style="margin-bottom:4px">Path</div>
            <input class="edit-input" id="rules-test-path" placeholder="users/uid/tvs">
          </div>
          <div>
            <div class="edit-label" style="margin-bottom:4px">Email simulado</div>
            <input class="edit-input" id="rules-test-email" placeholder="user@email.com">
          </div>
          <div>
            <div class="edit-label" style="margin-bottom:4px">Opera√ß√£o</div>
            <select class="edit-input" id="rules-test-op">
              <option value="read">read</option>
              <option value="write">write</option>
            </select>
          </div>
          <div style="grid-column:1/-1">
            <button class="btn-sm primary" onclick="testRule()">‚ñ∂ Testar no Firebase</button>
            <span id="rules-test-result" style="margin-left:12px;font-family:var(--mono);font-size:12px"></span>
          </div>
        </div>
      </div>
    </div>

    <!-- APPS & ACTIVE -->
    <div class="section" id="apps-section">
      <div class="page-header">
        <div>
          <div class="page-title">App &amp; Active</div>
          <div class="page-sub">Upload de releases ‚Äî APK, Windows e Linux</div>
        </div>
        <button class="btn-sm" onclick="loadAppsSection()">&#8635; Atualizar</button>
      </div>

      <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px;margin-bottom:24px">

        <!-- Card APK -->
        <div class="table-card" style="margin-bottom:0">
          <div class="table-header">
            <div class="table-title">&#128241; APP ANDROID (APK)</div>
            <span class="badge badge-gray" id="apk-version-badge">sem vers√£o</span>
          </div>
          <div style="padding:20px;display:flex;flex-direction:column;gap:12px">
            <div id="apk-current-info" style="padding:10px 12px;background:var(--bg3);border-radius:var(--radius);font-size:12px;font-family:var(--mono);color:var(--text3);line-height:1.6">
              Nenhuma vers√£o publicada ainda.
            </div>
            <div class="edit-field" style="margin:0">
              <div class="edit-label">Selecionar novo APK</div>
              <input type="file" id="apk-file-input" accept=".apk" style="display:none" onchange="previewReleaseFile('apk')">
              <button class="btn-sm" onclick="document.getElementById('apk-file-input').click()" style="width:100%">&#128193; Escolher arquivo .apk</button>
              <div id="apk-file-preview" style="display:none;margin-top:8px;padding:8px 10px;background:var(--bg3);border-radius:var(--radius);font-size:11px;font-family:var(--mono);color:var(--text2)"></div>
            </div>
            <div class="edit-field" style="margin:0">
              <div class="edit-label">Nota de atualiza√ß√£o</div>
              <input class="edit-input" id="apk-note" placeholder="ex: Corre√ß√£o de bug na reprodu√ß√£o de v√≠deo" style="font-size:12px">
            </div>
            <div style="height:4px;background:var(--bg3);border-radius:2px;overflow:hidden;display:none" id="apk-progress-bar">
              <div id="apk-progress-fill" style="height:100%;width:0%;background:var(--green);border-radius:2px;transition:width .3s"></div>
            </div>
            <button class="btn-sm primary" id="apk-upload-btn" onclick="uploadRelease('apk')" disabled>&#8679; Publicar APK</button>
          </div>
        </div>

        <!-- Card Windows -->
        <div class="table-card" style="margin-bottom:0">
          <div class="table-header">
            <div class="table-title">&#9000; SOFTWARE WINDOWS (.exe)</div>
            <span class="badge badge-gray" id="win-version-badge">sem vers√£o</span>
          </div>
          <div style="padding:20px;display:flex;flex-direction:column;gap:12px">
            <div id="win-current-info" style="padding:10px 12px;background:var(--bg3);border-radius:var(--radius);font-size:12px;font-family:var(--mono);color:var(--text3);line-height:1.6">
              Nenhuma vers√£o publicada ainda.
            </div>
            <div class="edit-field" style="margin:0">
              <div class="edit-label">Selecionar novo .exe</div>
              <input type="file" id="win-file-input" accept=".exe,.msi" style="display:none" onchange="previewReleaseFile('win')">
              <button class="btn-sm" onclick="document.getElementById('win-file-input').click()" style="width:100%">&#128193; Escolher arquivo .exe</button>
              <div id="win-file-preview" style="display:none;margin-top:8px;padding:8px 10px;background:var(--bg3);border-radius:var(--radius);font-size:11px;font-family:var(--mono);color:var(--text2)"></div>
            </div>
            <div class="edit-field" style="margin:0">
              <div class="edit-label">Nota de atualiza√ß√£o</div>
              <input class="edit-input" id="win-note" placeholder="ex: Novo suporte a monitor dual" style="font-size:12px">
            </div>
            <div style="height:4px;background:var(--bg3);border-radius:2px;overflow:hidden;display:none" id="win-progress-bar">
              <div id="win-progress-fill" style="height:100%;width:0%;background:var(--green);border-radius:2px;transition:width .3s"></div>
            </div>
            <button class="btn-sm primary" id="win-upload-btn" onclick="uploadRelease('win')" disabled>&#8679; Publicar Windows</button>
          </div>
        </div>

        <!-- Card Linux -->
        <div class="table-card" style="margin-bottom:0">
          <div class="table-header">
            <div class="table-title">&#128039; SOFTWARE LINUX</div>
            <span class="badge badge-gray" id="linux-version-badge">sem vers√£o</span>
          </div>
          <div style="padding:20px;display:flex;flex-direction:column;gap:12px">
            <div id="linux-current-info" style="padding:10px 12px;background:var(--bg3);border-radius:var(--radius);font-size:12px;font-family:var(--mono);color:var(--text3);line-height:1.6">
              Nenhuma vers√£o publicada ainda.
            </div>
            <div class="edit-field" style="margin:0">
              <div class="edit-label">Selecionar arquivo Linux</div>
              <input type="file" id="linux-file-input" accept=".deb,.AppImage,.sh,.run,.rpm" style="display:none" onchange="previewReleaseFile('linux')">
              <button class="btn-sm" onclick="document.getElementById('linux-file-input').click()" style="width:100%">&#128193; Escolher arquivo Linux</button>
              <div id="linux-file-preview" style="display:none;margin-top:8px;padding:8px 10px;background:var(--bg3);border-radius:var(--radius);font-size:11px;font-family:var(--mono);color:var(--text2)"></div>
            </div>
            <div class="edit-field" style="margin:0">
              <div class="edit-label">Nota de atualiza√ß√£o</div>
              <input class="edit-input" id="linux-note" placeholder="ex: Compatibilidade com Ubuntu 24.04" style="font-size:12px">
            </div>
            <div style="height:4px;background:var(--bg3);border-radius:2px;overflow:hidden;display:none" id="linux-progress-bar">
              <div id="linux-progress-fill" style="height:100%;width:0%;background:var(--green);border-radius:2px;transition:width .3s"></div>
            </div>
            <button class="btn-sm primary" id="linux-upload-btn" onclick="uploadRelease('linux')" disabled>&#8679; Publicar Linux</button>
          </div>
        </div>
      </div>

      <!-- Hist√≥rico -->
      <div class="table-card">
        <div class="table-header">
          <div class="table-title">HIST√ìRICO DE RELEASES</div>
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Plataforma</th><th>Arquivo</th><th>Nota</th><th>Publicado em</th><th>Tamanho</th><th>Download</th></tr></thead>
            <tbody id="releases-history-body">
              <tr><td colspan="6" class="loading"><div class="spinner"></div>Carregando...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- DOM√çNIOS -->
    <div class="section" id="dominios-section">
      <div class="page-header">
        <div>
          <div class="page-title">Dom√≠nios</div>
          <div class="page-sub">Todos os dom√≠nios e propriedades web do DSigner</div>
        </div>
        <button class="btn-sm" onclick="checkAllDomains()">‚Üª Verificar Status</button>
      </div>

      <div class="stats-grid" style="grid-template-columns:repeat(auto-fill,minmax(160px,1fr))">
        <div class="stat-card"><div class="stat-label">Dom√≠nios</div><div class="stat-value" id="site-stat-total">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Online</div><div class="stat-value" id="site-stat-online" style="color:var(--green)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">SSL V√°lido</div><div class="stat-value" id="site-stat-ssl" style="color:var(--blue)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Verificando</div><div class="stat-value" id="site-stat-checking" style="color:var(--yellow)">‚Äî</div></div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">DOM√çNIOS REGISTRADOS</div>
          <div class="table-actions">
            <button class="btn-sm primary" onclick="openModal('add-domain-modal')">+ Adicionar</button>
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Dom√≠nio</th><th>Tipo</th><th>Status</th><th>SSL</th><th>Registrador</th><th>Notas</th><th>A√ß√µes</th></tr></thead>
            <tbody id="sites-body"></tbody>
          </table>
        </div>
      </div>
    </div>


    <!-- ===== PLANOS ===== -->
    <div class="section" id="plans-section">
      <div class="page-header">
        <div>
          <div class="page-title">Planos de Armazenamento</div>
          <div class="page-sub">Gerencie cotas individualmente ou em lote</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn-sm" onclick="loadPlans()">‚Üª Atualizar</button>
          <button class="btn-sm primary" onclick="openBulkPlanModal()">‚ö° Aplicar em lote</button>
        </div>
      </div>

      <!-- Stats -->
      <div class="stats-grid" style="grid-template-columns:repeat(auto-fill,minmax(160px,1fr));margin-bottom:16px">
        <div class="stat-card"><div class="stat-label">Usu√°rios</div><div class="stat-value" id="plan-stat-users">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Storage Total</div><div class="stat-value" id="plan-stat-total">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Storage Usado</div><div class="stat-value" id="plan-stat-used">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Acima de 80%</div><div class="stat-value" id="plan-stat-warn" style="color:var(--yellow)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Cheios (100%)</div><div class="stat-value" id="plan-stat-full" style="color:var(--red)">‚Äî</div></div>
      </div>

      <!-- Tabela de planos -->
      <div class="table-card">
        <div class="table-header">
          <div class="table-title">USU√ÅRIOS & PLANOS</div>
          <div class="table-actions">
            <input class="search-input" id="plan-search" placeholder="Filtrar..." oninput="filterTable('plans-body', this.value)">
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th style="width:32px"><input type="checkbox" id="plan-select-all" onchange="toggleSelectAllPlans(this.checked)"></th>
                <th>Email</th>
                <th>Plano</th>
                <th>Usado</th>
                <th style="min-width:140px">Uso</th>
                <th>%</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="plans-body"><tr><td colspan="7" class="loading"><div class="spinner"></div>Carregando...</td></tr></tbody>
          </table>
        </div>
        <div style="padding:10px 16px;border-top:1px solid var(--border);display:flex;align-items:center;gap:10px;flex-wrap:wrap">
          <span id="plans-selected-count" style="font-size:12px;font-family:var(--mono);color:var(--ink-dim)">0 selecionados</span>
          <button class="btn-sm" id="bulk-apply-selected-btn" onclick="openBulkPlanModal()" style="display:none">‚ö° Alterar selecionados</button>
        </div>
      </div>
    </div>

    <!-- ===== CHAMADOS ===== -->
    <div class="section" id="tickets-section">
      <div class="page-header">
        <div>
          <div class="page-title">Chamados de Suporte</div>
          <div class="page-sub">Mensagens enviadas pelos usu√°rios pelo painel</div>
        </div>
        <button class="btn-sm" onclick="loadTickets()">‚Üª Atualizar</button>
      </div>

      <!-- Stats chamados -->
      <div class="stats-grid" style="grid-template-columns:repeat(auto-fill,minmax(140px,1fr));margin-bottom:16px">
        <div class="stat-card"><div class="stat-label">Total</div><div class="stat-value" id="ticket-stat-total">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Abertos</div><div class="stat-value" id="ticket-stat-open" style="color:var(--blue)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Aguardando</div><div class="stat-value" id="ticket-stat-pending" style="color:var(--yellow)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Resolvidos</div><div class="stat-value" id="ticket-stat-done" style="color:var(--green)">‚Äî</div></div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">CHAMADOS</div>
          <div class="table-actions">
            <select class="search-input" id="ticket-filter-status" style="width:140px" onchange="loadTickets()">
              <option value="">Todos</option>
              <option value="open">Abertos</option>
              <option value="pending">Aguardando</option>
              <option value="closed">Resolvidos</option>
            </select>
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead><tr><th>Usu√°rio</th><th>Assunto</th><th>Mensagem</th><th>Data</th><th>Status</th><th>Chat</th><th>A√ß√µes</th></tr></thead>
            <tbody id="tickets-body"><tr><td colspan="7" class="loading"><div class="spinner"></div>Carregando...</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ===== CHANGE PLANS ===== -->
    <div class="section" id="change-plans-section">
      <div class="page-header">
        <div>
          <div class="page-title">Change Plans</div>
          <div class="page-sub">Solicita√ß√µes de mudan√ßa de plano e cobran√ßas</div>
        </div>
        <button class="btn-sm" onclick="loadChangePlans()">‚Üª Atualizar</button>
      </div>

      <div class="stats-grid" style="grid-template-columns:repeat(auto-fill,minmax(150px,1fr));margin-bottom:16px">
        <div class="stat-card"><div class="stat-label">Pendentes</div><div class="stat-value" id="cp-stat-pending" style="color:var(--yellow)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Aguardando Pgto</div><div class="stat-value" id="cp-stat-waiting" style="color:var(--blue)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Pagos (m√™s)</div><div class="stat-value" id="cp-stat-paid" style="color:var(--green)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Vencendo em 2d</div><div class="stat-value" id="cp-stat-expiring" style="color:var(--red)">‚Äî</div></div>
        <div class="stat-card"><div class="stat-label">Inadimplentes</div><div class="stat-value" id="cp-stat-overdue" style="color:var(--red)">‚Äî</div></div>
      </div>

      <div class="table-card">
        <div class="table-header">
          <div class="table-title">SOLICITA√á√ïES & ASSINATURAS</div>
          <div class="table-actions" style="gap:8px;flex-wrap:wrap">
            <select class="search-input" id="cp-filter-status" style="width:160px" onchange="loadChangePlans()">
              <option value="">Todos</option>
              <option value="pending">Pendentes</option>
              <option value="awaiting_payment">Aguardando Pgto</option>
              <option value="active">Ativos</option>
              <option value="overdue">Inadimplentes</option>
            </select>
            <input class="search-input" id="cp-search" placeholder="Buscar..." oninput="filterTable('cp-body', this.value)" style="width:160px">
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th>Usu√°rio</th>
                <th>Plano Atual</th>
                <th>Plano Solicitado</th>
                <th>Data</th>
                <th>Vencimento</th>
                <th>Status</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="cp-body"><tr><td colspan="7" class="loading"><div class="spinner"></div>Carregando...</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ===== SETTINGS ===== -->
    <div class="section" id="settings-section">
      <div class="page-header">
        <div>
          <div class="page-title">Settings</div>
          <div class="page-sub">Configure os planos, chaves Pix e QR Codes para cobran√ßas</div>
        </div>
        <button class="btn-sm primary" onclick="saveSettings()">üíæ Salvar tudo</button>
      </div>

      <div id="settings-plans-container" style="display:flex;flex-direction:column;gap:16px">
        <div class="loading" style="padding:24px;text-align:center"><div class="spinner"></div>Carregando...</div>
      </div>
    </div>

  </main>
</div>


<!-- MODAL: Change Plan Detail -->
<div class="modal-overlay" id="cp-modal">
  <div class="modal" style="max-width:560px">
    <div class="modal-head">
      <div>
        <div class="modal-head-title" id="cp-modal-title">Solicita√ß√£o de Plano</div>
        <div style="font-size:11px;font-family:var(--mono);color:var(--ink-dim)" id="cp-modal-sub"></div>
      </div>
      <button class="modal-close" onclick="closeModal('cp-modal')">√ó</button>
    </div>
    <div class="modal-body">

      <!-- Info da solicita√ß√£o -->
      <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:12px 14px;margin-bottom:14px">
        <div style="font-size:11px;font-family:var(--mono);color:var(--ink-dim);margin-bottom:8px">SOLICITA√á√ÉO</div>
        <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:13px">
          <div><span style="color:var(--ink-dim)">Plano atual:</span> <strong id="cp-modal-current">‚Äî</strong></div>
          <div><span style="color:var(--ink-dim)">Plano solicitado:</span> <strong id="cp-modal-requested" style="color:var(--blue)">‚Äî</strong></div>
          <div><span style="color:var(--ink-dim)">Valor:</span> <strong id="cp-modal-value" style="color:var(--green)">‚Äî</strong></div>
          <div><span style="color:var(--ink-dim)">Vencimento atual:</span> <strong id="cp-modal-expiry">‚Äî</strong></div>
        </div>
        <div id="cp-modal-msg" style="margin-top:10px;font-size:12px;color:var(--ink-muted);border-top:1px solid var(--border);padding-top:8px;white-space:pre-wrap"></div>
      </div>

      <!-- Comprovante enviado pelo usu√°rio -->
      <div id="cp-modal-proof-wrap" style="display:none;background:var(--bg);border:1px solid var(--green);border-radius:var(--radius);padding:12px 14px;margin-bottom:14px">
        <div style="font-size:11px;font-family:var(--mono);color:var(--green);margin-bottom:6px">‚úÖ COMPROVANTE ENVIADO PELO USU√ÅRIO</div>
        <div id="cp-modal-proof-info" style="font-size:12px;color:var(--ink-muted)"></div>
        <a id="cp-modal-proof-link" href="#" target="_blank" style="display:inline-block;margin-top:8px;font-size:12px;color:var(--blue)">Ver comprovante ‚Üí</a>
      </div>

      <!-- A√ß√µes -->
      <div style="display:flex;flex-direction:column;gap:10px">
        <div class="edit-field">
          <div class="edit-label">Plano a aplicar</div>
          <select class="edit-input" id="cp-modal-plan-select">
            <option value="50mb">50 MB ‚Äî Gratuito</option>
            <option value="100mb">100 MB</option>
            <option value="512mb">512 MB</option>
            <option value="1gb">1 GB</option>
            <option value="2gb">2 GB</option>
            <option value="5gb">5 GB</option>
            <option value="10gb">10 GB</option>
            <option value="20gb">20 GB</option>
          </select>
        </div>
        <div class="edit-field">
          <div class="edit-label">Nota interna</div>
          <textarea class="edit-input" id="cp-modal-note" rows="2" placeholder="Observa√ß√µes..." style="resize:vertical;font-family:var(--sans)"></textarea>
        </div>
      </div>
      <input type="hidden" id="cp-modal-id">
      <input type="hidden" id="cp-modal-userid">
    </div>
    <div class="modal-footer" style="flex-wrap:wrap;gap:8px">
      <button class="btn-sm danger" onclick="closeModal('cp-modal')">Cancelar</button>
      <button class="btn-sm" onclick="applyPlanChange()" style="background:var(--green);color:#000;border-color:var(--green)">‚úÖ Aplicar Plano</button>
      <button class="btn-sm primary" onclick="sendBillingToUser()">üí∞ Enviar Cobran√ßa</button>
    </div>
  </div>
</div>

<!-- MODAL: Bulk Plan -->

<div class="modal-overlay" id="bulk-plan-modal">
  <div class="modal" style="max-width:460px">
    <div class="modal-head">
      <div class="modal-head-title" id="bulk-plan-modal-title">‚ö° Aplicar Plano em Lote</div>
      <button class="modal-close" onclick="closeModal('bulk-plan-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <div id="bulk-plan-target-info" style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:10px 14px;margin-bottom:16px;font-size:12px;font-family:var(--mono);color:var(--ink-muted);line-height:1.6;"></div>
      <div class="edit-field">
        <div class="edit-label">Cota de armazenamento</div>
        <select class="edit-input" id="bulk-quota-select" onchange="onBulkQuotaChange()">
          <option value="536870912">512 MB</option>
          <option value="1073741824" selected>1 GB (padr√£o)</option>
          <option value="2147483648">2 GB</option>
          <option value="5368709120">5 GB</option>
          <option value="10737418240">10 GB</option>
          <option value="21474836480">20 GB</option>
          <option value="custom">Personalizado‚Ä¶</option>
        </select>
      </div>
      <div class="edit-field" id="bulk-custom-row" style="display:none">
        <div class="edit-label">Valor em GB</div>
        <input class="edit-input" id="bulk-custom-gb" type="number" min="0.1" step="0.5" placeholder="ex: 3">
      </div>
      <div class="edit-field">
        <div class="edit-label">R√≥tulo (opcional)</div>
        <input class="edit-input" id="bulk-label-input" placeholder="ex: Plano Pro">
      </div>
      <div id="bulk-plan-progress" style="display:none;margin-top:10px">
        <div style="font-size:12px;font-family:var(--mono);color:var(--ink-muted);margin-bottom:4px" id="bulk-plan-progress-text">Aplicando...</div>
        <div style="height:4px;background:var(--bg);border-radius:2px;overflow:hidden">
          <div id="bulk-plan-progress-bar" style="height:100%;width:0%;background:var(--ink);border-radius:2px;transition:width .3s"></div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-sm" onclick="closeModal('bulk-plan-modal')">Cancelar</button>
      <button class="btn-sm primary" id="bulk-plan-save-btn" onclick="applyBulkPlan()">Aplicar</button>
    </div>
  </div>
</div>

<!-- MODAL: Ticket Detail / Chat -->
<div class="modal-overlay" id="ticket-modal">
  <div class="modal" style="max-width:560px">
    <div class="modal-head">
      <div style="display:flex;flex-direction:column;gap:2px">
        <div class="modal-head-title" id="ticket-modal-title">Chamado</div>
        <div style="font-size:11px;font-family:var(--mono);color:var(--ink-dim)" id="ticket-modal-sub"></div>
      </div>
      <button class="modal-close" onclick="closeModal('ticket-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <!-- Mensagem original -->
      <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:12px 14px;margin-bottom:14px">
        <div style="font-size:11px;font-family:var(--mono);color:var(--ink-dim);margin-bottom:6px">MENSAGEM ORIGINAL</div>
        <div id="ticket-original-msg" style="font-size:13px;color:var(--ink);line-height:1.6;white-space:pre-wrap"></div>
      </div>

      <!-- Chat (futuro - placeholder) -->
      <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:12px 14px;margin-bottom:14px">
        <div style="font-size:11px;font-family:var(--mono);color:var(--ink-dim);margin-bottom:8px;display:flex;align-items:center;gap:8px">
          CHAT EM TEMPO REAL
          <span style="background:var(--yellow-bg,#fef8e7);color:var(--yellow);border:1px solid var(--yellow);padding:1px 7px;border-radius:3px;font-size:10px;">em breve</span>
        </div>
        <div id="ticket-chat-messages" style="min-height:80px;max-height:200px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;padding:4px 0">
          <div style="text-align:center;color:var(--ink-dim);font-size:12px;font-family:var(--mono);padding:20px 0">
            üí¨ Chat dispon√≠vel em breve ‚Äî por enquanto responda via status abaixo
          </div>
        </div>
      </div>

      <!-- Status + resposta -->
      <div class="edit-field">
        <div class="edit-label">Status do chamado</div>
        <select class="edit-input" id="ticket-status-select">
          <option value="open">Aberto</option>
          <option value="pending">Aguardando usu√°rio</option>
          <option value="closed">Resolvido</option>
        </select>
      </div>
      <div class="edit-field">
        <div class="edit-label">Nota interna (s√≥ vis√≠vel aqui)</div>
        <textarea class="edit-input" id="ticket-note-input" rows="3" placeholder="Observa√ß√µes internas sobre este chamado..." style="resize:vertical;min-height:70px;font-family:var(--sans);"></textarea>
      </div>
      <input type="hidden" id="ticket-modal-id">
    </div>
    <div class="modal-footer">
      <button class="btn-sm danger" onclick="deleteTicket()">Excluir</button>
      <button class="btn-sm" onclick="closeModal('ticket-modal')">Fechar</button>
      <button class="btn-sm primary" onclick="saveTicket()">Salvar</button>
    </div>
  </div>
</div>

<!-- MODAL: Node Detail -->
<div class="modal-overlay" id="node-modal">
  <div class="modal">
    <div class="modal-head">
      <div class="modal-head-title" id="node-modal-title">N√≥</div>
      <button class="modal-close" onclick="closeModal('node-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <div id="node-modal-content"></div>
    </div>
    <div class="modal-footer">
      <button class="btn-sm danger" id="node-delete-btn" onclick="confirmDeleteNode()">üóë Excluir n√≥</button>
      <button class="btn-sm" onclick="closeModal('node-modal')">Fechar</button>
      <button class="btn-sm primary" id="node-save-btn" onclick="saveNodeEdit()">Salvar</button>
    </div>
  </div>
</div>

<!-- MODAL: Raw JSON -->
<div class="modal-overlay" id="raw-modal">
  <div class="modal" style="max-width:800px">
    <div class="modal-head">
      <div class="modal-head-title" id="raw-modal-title">JSON Raw</div>
      <button class="modal-close" onclick="closeModal('raw-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <div class="json-viewer" id="raw-modal-content"></div>
    </div>
    <div class="modal-footer">
      <button class="btn-sm" onclick="copyRaw()">‚éò Copiar</button>
      <button class="btn-sm" onclick="closeModal('raw-modal')">Fechar</button>
    </div>
  </div>
</div>

<!-- MODAL: Gerenciar Plano do Usu√°rio -->
<div class="modal-overlay" id="plan-modal">
  <div class="modal" style="max-width:420px">
    <div class="modal-head">
      <div class="modal-head-title">‚öô Plano de Armazenamento</div>
      <button class="modal-close" onclick="closeModal('plan-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <div style="font-family:var(--mono);font-size:13px;color:var(--ink-muted);margin-bottom:4px;" id="plan-modal-email"></div>
      <div style="font-family:var(--mono);font-size:11px;color:var(--ink-dim);margin-bottom:16px;" id="plan-modal-usage"></div>
      <input type="hidden" id="plan-modal-uid">

      <div class="edit-field">
        <div class="edit-label">Cota de armazenamento</div>
        <select class="edit-input" id="plan-quota-select" onchange="onPlanSelectChange()">
          <option value="536870912">512 MB</option>
          <option value="1073741824" selected>1 GB (padr√£o)</option>
          <option value="2147483648">2 GB</option>
          <option value="5368709120">5 GB</option>
          <option value="10737418240">10 GB</option>
          <option value="21474836480">20 GB</option>
          <option value="custom">Personalizado‚Ä¶</option>
        </select>
      </div>

      <div class="edit-field" id="plan-custom-row" style="display:none">
        <div class="edit-label">Valor personalizado (GB)</div>
        <input class="edit-input" id="plan-custom-gb" type="number" min="0.1" step="0.5" placeholder="ex: 7.5">
      </div>

      <div class="edit-field">
        <div class="edit-label">R√≥tulo do plano (opcional)</div>
        <input class="edit-input" id="plan-label-input" placeholder="ex: Plano Pro, Cortesia, etc">
      </div>

      <div style="background:var(--bg);border:1px solid var(--border);border-radius:var(--radius);padding:10px 12px;margin-top:8px;font-size:11px;font-family:var(--mono);color:var(--ink-dim);line-height:1.6;">
        ‚Ñπ O plano √© salvo em <code>users/{uid}/plan</code> no Realtime Database.<br>
        O painel l√™ esse valor em tempo real e bloqueia uploads ao atingir 100%.
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-sm" onclick="closeModal('plan-modal')">Cancelar</button>
      <button class="btn-sm primary" id="save-plan-btn" onclick="savePlan()">Salvar Plano</button>
    </div>
  </div>
</div>

<!-- MODAL: Criar Usu√°rio -->
<div class="modal-overlay" id="create-user-modal">
  <div class="modal" style="max-width:440px">
    <div class="modal-head">
      <div class="modal-head-title">+ Criar Novo Usu√°rio</div>
      <button class="modal-close" onclick="closeModal('create-user-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <div style="background:var(--blue-bg);border:1px solid var(--blue);border-radius:var(--radius);padding:10px 14px;margin-bottom:16px;font-size:12px;color:var(--blue);font-family:var(--mono)">
        ‚Ñπ Cria o usu√°rio no Firebase Auth e inicializa a estrutura no Realtime Database.
      </div>
      <div class="edit-field">
        <div class="edit-label">Email</div>
        <input class="edit-input" id="new-user-email" type="email" placeholder="usuario@email.com">
      </div>
      <div class="edit-field">
        <div class="edit-label">Senha</div>
        <input class="edit-input" id="new-user-pass" type="password" placeholder="m√≠nimo 6 caracteres">
      </div>
      <div class="edit-field">
        <div class="edit-label">Nome / Empresa (opcional)</div>
        <input class="edit-input" id="new-user-name" placeholder="ex: Hotel Exemplo">
      </div>
      <div id="create-user-error" style="display:none;margin-top:8px;padding:8px 12px;background:var(--red-bg);color:var(--red);border-radius:var(--radius);font-size:12px;font-family:var(--mono)"></div>
    </div>
    <div class="modal-footer">
      <button class="btn-sm" onclick="closeModal('create-user-modal')">Cancelar</button>
      <button class="btn-sm primary" id="create-user-btn" onclick="createUser()">Criar Usu√°rio</button>
    </div>
  </div>
</div>

<!-- MODAL: Criar TV -->
<div class="modal-overlay" id="create-tv-modal">
  <div class="modal" style="max-width:440px">
    <div class="modal-head">
      <div class="modal-head-title" id="create-tv-modal-title">+ Nova TV</div>
      <button class="modal-close" onclick="closeModal('create-tv-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <div class="edit-field">
        <div class="edit-label">Nome da TV</div>
        <input class="edit-input" id="new-tv-name" placeholder="ex: TV Recep√ß√£o">
      </div>
      <div class="edit-field">
        <div class="edit-label">Categoria</div>
        <select class="edit-input" id="new-tv-category">
          <option value="">‚Äî sem categoria ‚Äî</option>
        </select>
      </div>
      <div class="edit-field">
        <div class="edit-label">Activation Key (opcional)</div>
        <input class="edit-input" id="new-tv-key" placeholder="ex: ABC123">
      </div>
      <div class="edit-field">
        <div class="edit-label">Status inicial</div>
        <select class="edit-input" id="new-tv-status">
          <option value="on">online</option>
          <option value="off">offline</option>
        </select>
      </div>
      <div id="create-tv-error" style="display:none;margin-top:8px;padding:8px 12px;background:var(--red-bg);color:var(--red);border-radius:var(--radius);font-size:12px;font-family:var(--mono)"></div>
    </div>
    <div class="modal-footer">
      <button class="btn-sm" onclick="closeModal('create-tv-modal')">Cancelar</button>
      <button class="btn-sm primary" onclick="createTv()">Criar TV</button>
    </div>
  </div>
</div>

<!-- MODAL: Adicionar Dom√≠nio -->
<div class="modal-overlay" id="add-domain-modal">
  <div class="modal" style="max-width:480px">
    <div class="modal-head">
      <div class="modal-head-title">+ Adicionar Dom√≠nio</div>
      <button class="modal-close" onclick="closeModal('add-domain-modal')">√ó</button>
    </div>
    <div class="modal-body">
      <div class="edit-field">
        <div class="edit-label">Dom√≠nio</div>
        <input class="edit-input" id="new-domain-url" placeholder="ex: dsignertv.com.br">
      </div>
      <div class="edit-field">
        <div class="edit-label">Tipo</div>
        <select class="edit-input" id="new-domain-type">
          <option value="principal">Principal</option>
          <option value="landing">Landing Page</option>
          <option value="painel">Painel / App</option>
          <option value="api">API / Backend</option>
          <option value="dev">Dev / Staging</option>
          <option value="outro">Outro</option>
        </select>
      </div>
      <div class="edit-field">
        <div class="edit-label">Registrador</div>
        <input class="edit-input" id="new-domain-registrar" placeholder="ex: Registro.br, GoDaddy, Cloudflare">
      </div>
      <div class="edit-field">
        <div class="edit-label">Notas</div>
        <input class="edit-input" id="new-domain-notes" placeholder="ex: Hospedado na Vercel, renova√ß√£o jan/2026">
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-sm" onclick="closeModal('add-domain-modal')">Cancelar</button>
      <button class="btn-sm primary" onclick="addDomain()">Adicionar</button>
    </div>
  </div>
</div>

<!-- CONFIRM -->
<div id="confirm-overlay">
  <div class="confirm-box">
    <div class="confirm-title" id="confirm-title">Confirmar</div>
    <div class="confirm-msg" id="confirm-msg">Tem certeza?</div>
    <div class="confirm-btns">
      <button class="btn-sm" onclick="resolveConfirm(false)">Cancelar</button>
      <button class="btn-sm danger" onclick="resolveConfirm(true)">Confirmar</button>
    </div>
  </div>
</div>

<!-- TOAST -->
<div id="toast-container"></div>



<script src="developer.js"></script>

</body>
</html>