<button class="nav-item nav-item-disabled" ... disabled>

<button class="nav-item" ... >

destravar


# ğŸ“ Estrutura Modular do Painel.js

## ğŸ“‹ VisÃ£o Geral

O cÃ³digo foi dividido em **14 mÃ³dulos** independentes e organizados por funcionalidade. Cada arquivo tem uma responsabilidade especÃ­fica, facilitando a manutenÃ§Ã£o e evoluÃ§Ã£o do sistema.

---

## ğŸ—‚ï¸ Estrutura de Arquivos

```
js/
â”œâ”€â”€ config.js              # ConfiguraÃ§Ãµes globais e constantes
â”œâ”€â”€ state.js               # Gerenciamento de estado global
â”œâ”€â”€ auth.js                # AutenticaÃ§Ã£o do usuÃ¡rio
â”œâ”€â”€ toast.js               # Sistema de notificaÃ§Ãµes
â”œâ”€â”€ firebase-sync.js       # SincronizaÃ§Ã£o com Firebase
â”œâ”€â”€ ui-render.js           # RenderizaÃ§Ã£o de listas (categorias/TVs)
â”œâ”€â”€ sidebar.js             # Gerenciamento da barra lateral
â”œâ”€â”€ navigation.js          # Sistema de navegaÃ§Ã£o entre seÃ§Ãµes
â”œâ”€â”€ category-manager.js    # CRUD de categorias/grupos
â”œâ”€â”€ tv-manager.js          # CRUD e controles de TVs
â”œâ”€â”€ tv-media-viewer.js     # VisualizaÃ§Ã£o de mÃ­dia e playlist
â”œâ”€â”€ dropzone.js            # Sistema de arrastar e soltar arquivos
â”œâ”€â”€ upload-tabs.js         # Gerenciamento de abas de upload
â”œâ”€â”€ upload-handler.js      # ManipulaÃ§Ã£o de uploads
â”œâ”€â”€ icloud-manager.js      # Gerenciamento de mÃ­dias salvas
â”œâ”€â”€ media-manager.js       # Gerenciamento da lista de mÃ­dias
â”œâ”€â”€ modals.js              # Gerenciamento de modais e FAB
â””â”€â”€ main.js                # InicializaÃ§Ã£o da aplicaÃ§Ã£o
```

---

## ğŸ“¦ DescriÃ§Ã£o dos MÃ³dulos

### ğŸ”§ **config.js**
**Responsabilidade:** ConfiguraÃ§Ãµes globais e constantes
- Ãcones (PLAY_ICON, BLACK_IMAGE_URL)
- Limites de tamanho (MAX_FILE_SIZE)
- Tempos de duraÃ§Ã£o (toasts, animaÃ§Ãµes)
- Helpers globais (isOnline, tvSlugFromName, getMediaNameFromUrl)

### ğŸ—„ï¸ **state.js**
**Responsabilidade:** Gerenciamento do estado global da aplicaÃ§Ã£o
- Estado centralizado (categories, tvs, selectedCategoryId, etc.)
- Getters e setters para acesso controlado
- Evita variÃ¡veis globais espalhadas

### ğŸ” **auth.js**
**Responsabilidade:** AutenticaÃ§Ã£o de usuÃ¡rios
- Monitoramento de estado de login
- Redirecionamento se nÃ£o autenticado
- AtualizaÃ§Ã£o de dados do usuÃ¡rio na UI

### ğŸ”” **toast.js**
**Responsabilidade:** Sistema de notificaÃ§Ãµes
- ExibiÃ§Ã£o de toasts (success, error, info)
- Controle de duraÃ§Ã£o e animaÃ§Ãµes
- Indicador de status de rede

### ğŸ”„ **firebase-sync.js**
**Responsabilidade:** SincronizaÃ§Ã£o com Firebase
- Buscar dados remotos (categorias, TVs, mÃ­dias)
- Atualizar status de mÃ­dias ativas
- Enviar comandos para TVs (stop, etc.)

### ğŸ¨ **ui-render.js**
**Responsabilidade:** RenderizaÃ§Ã£o de listas
- Atualizar lista de categorias/grupos
- Atualizar grid de TVs
- Manter UI sincronizada com o estado

### ğŸ“± **sidebar.js**
**Responsabilidade:** Barra lateral
- Toggle desktop (expandir/colapsar)
- Toggle mobile (abrir/fechar)
- PersistÃªncia de estado no localStorage

### ğŸ§­ **navigation.js**
**Responsabilidade:** NavegaÃ§Ã£o entre seÃ§Ãµes
- Alternar entre abas (Dashboard, MÃ­dias, etc.)
- Links especiais (logout, dskey)
- Carregamento de dados por seÃ§Ã£o

### ğŸ“‚ **category-manager.js**
**Responsabilidade:** CRUD de categorias
- Adicionar categoria
- Editar categoria
- Deletar categoria (e TVs associadas)
- SeleÃ§Ã£o de categoria ativa

### ğŸ“º **tv-manager.js**
**Responsabilidade:** CRUD e controles de TVs
- Adicionar TV
- Deletar TV
- Ligar/Desligar TV
- Gerenciar chave de ativaÃ§Ã£o
- Abrir modal de informaÃ§Ãµes

### ğŸ¬ **tv-media-viewer.js**
**Responsabilidade:** VisualizaÃ§Ã£o de mÃ­dia
- Exibir mÃ­dia Ãºnica (imagem/vÃ­deo)
- Exibir e gerenciar playlist
- Drag & drop de itens da playlist
- Adicionar/remover itens da playlist
- Atualizar playlist na TV

### ğŸ“¥ **dropzone.js**
**Responsabilidade:** Sistema de arrastar e soltar
- Drag and drop de arquivos
- Preview de imagens
- Lista de arquivos selecionados
- ValidaÃ§Ã£o de mÃºltiplos arquivos

### ğŸ”„ **upload-tabs.js**
**Responsabilidade:** Abas de upload
- Alternar entre modos (arquivo, link, iCloud)
- Toggle de playlist
- Controle de campos dinÃ¢micos (duraÃ§Ã£o/loop)

### â¬†ï¸ **upload-handler.js**
**Responsabilidade:** ManipulaÃ§Ã£o de uploads
- Upload para Firebase Storage
- Registro de mÃ­dia no banco de dados
- Upload de arquivo Ãºnico
- Upload de playlist (mÃºltiplos arquivos)
- Upload via link

### â˜ï¸ **icloud-manager.js**
**Responsabilidade:** MÃ­dias salvas (iCloud)
- Listar mÃ­dias salvas
- Buscar mÃ­dias
- Atribuir mÃ­dia existente a uma TV
- Evitar duplicaÃ§Ã£o de uploads

### ğŸ—ƒï¸ **media-manager.js**
**Responsabilidade:** Lista de mÃ­dias (aba MÃ­dias)
- Listar todas as mÃ­dias
- Filtrar por TV e status
- Renomear mÃ­dia
- Deletar mÃ­dia
- Atualizar TVs que usam a mÃ­dia deletada

### ğŸªŸ **modals.js**
**Responsabilidade:** Modais e FAB
- Fechar modais (botÃ£o X ou clique fora)
- Gerenciar FAB (botÃ£o flutuante)

### ğŸš€ **main.js**
**Responsabilidade:** InicializaÃ§Ã£o
- Importar todos os mÃ³dulos
- Inicializar componentes na ordem correta
- Event listeners globais (online/offline)

---

## ğŸ”— Como os MÃ³dulos se Comunicam

### 1ï¸âƒ£ **Estado Centralizado** (state.js)
Todos os mÃ³dulos que precisam acessar ou modificar dados globais usam os getters/setters do `state.js`:

```javascript
import { getTvs, setSelectedCategoryId } from './state.js';
```

### 2ï¸âƒ£ **Helpers Compartilhados** (config.js)
FunÃ§Ãµes utilitÃ¡rias sÃ£o importadas de `config.js`:

```javascript
import { isOnline, tvSlugFromName } from './config.js';
```

### 3ï¸âƒ£ **NotificaÃ§Ãµes** (toast.js)
Qualquer mÃ³dulo pode exibir toasts:

```javascript
import { showToast } from './toast.js';
showToast('OperaÃ§Ã£o realizada!', 'success');
```

### 4ï¸âƒ£ **SincronizaÃ§Ã£o** (firebase-sync.js)
MÃ³dulos que alteram dados chamam `syncWithFirebase()`:

```javascript
import { syncWithFirebase } from './firebase-sync.js';
await syncWithFirebase();
```

### 5ï¸âƒ£ **RenderizaÃ§Ã£o** (ui-render.js)
ApÃ³s alteraÃ§Ãµes, atualiza a UI:

```javascript
import { updateTvGrid, updateCategoryList } from './ui-render.js';
updateTvGrid();
```

---

## ğŸ› ï¸ Como Adicionar no HTML

### OpÃ§Ã£o 1: MÃ³dulos ES6 (Recomendado)

```html
<script type="module" src="js/main.js"></script>
```

**Importante:** Todos os arquivos devem usar `export` e `import` (jÃ¡ estÃ¡ implementado).

### OpÃ§Ã£o 2: Bundler (Webpack/Vite)

Se preferir um arquivo Ãºnico para produÃ§Ã£o, use um bundler:

```bash
npm install --save-dev vite
npx vite build
```

---

## âœ… Vantagens da ModularizaÃ§Ã£o

âœ”ï¸ **ManutenÃ§Ã£o facilitada**: Cada arquivo tem uma responsabilidade clara  
âœ”ï¸ **CÃ³digo organizado**: FÃ¡cil encontrar onde estÃ¡ cada funcionalidade  
âœ”ï¸ **ReutilizaÃ§Ã£o**: MÃ³dulos podem ser usados em outros projetos  
âœ”ï¸ **Testes**: Cada mÃ³dulo pode ser testado isoladamente  
âœ”ï¸ **ColaboraÃ§Ã£o**: MÃºltiplos desenvolvedores podem trabalhar simultaneamente  
âœ”ï¸ **Performance**: Possibilidade de lazy loading  

---

## ğŸ” Onde Encontrar Cada Funcionalidade

| Funcionalidade | Arquivo |
|---|---|
| Adicionar categoria | `category-manager.js` |
| Editar categoria | `category-manager.js` |
| Deletar categoria | `category-manager.js` |
| Adicionar TV | `tv-manager.js` |
| Deletar TV | `tv-manager.js` |
| Ligar/Desligar TV | `tv-manager.js` |
| Enviar mÃ­dia | `upload-handler.js` |
| Ver playlist | `tv-media-viewer.js` |
| Arrastar arquivo | `dropzone.js` |
| Trocar aba upload | `upload-tabs.js` |
| Ver mÃ­dias salvas | `icloud-manager.js` |
| Listar todas mÃ­dias | `media-manager.js` |
| Renomear mÃ­dia | `media-manager.js` |
| Deletar mÃ­dia | `media-manager.js` |
| Sidebar mobile | `sidebar.js` |
| Trocar seÃ§Ã£o | `navigation.js` |

---

## ğŸš¨ ObservaÃ§Ãµes Importantes

1. **authModule** ainda estÃ¡ no `window.authModule` (mantido para compatibilidade)
2. **window.uploadMidia** Ã© exportado globalmente em `upload-handler.js`
3. Todos os IDs e classes HTML foram mantidos iguais
4. A lÃ³gica foi preservada 100%, apenas reorganizada
5. NÃ£o hÃ¡ perda de funcionalidade

---

## ğŸ¯ PrÃ³ximos Passos Sugeridos

1. âœ… Testar cada mÃ³dulo individualmente
2. âœ… Adicionar testes unitÃ¡rios
3. âœ… Implementar TypeScript (opcional)
4. âœ… Usar um bundler para produÃ§Ã£o
5. âœ… Adicionar source maps para debug

---

**Desenvolvido com â¤ï¸ para facilitar a manutenÃ§Ã£o do projeto**